(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{110:function(e,t,n){},127:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(32),c=n.n(o),i=(n(92),n(7)),s=(n(93),n(29)),l=n.n(s),u=(n(110),n(16)),p=n.n(u),d=n(22);function f(){return(f=Object(d.a)(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l()({url:"https://api.spotify.com/v1/audio-analysis/".concat(t),headers:{Authorization:"Bearer ".concat(n)},json:!0});case 3:return(a=e.sent).status&&console.log("GET ANALYSIS STATUS: ",a.status),console.log("THIS IS THE AUDIO ANALYSIS",a.data),e.abrupt("return",a.data);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function m(){return(m=Object(d.a)(p.a.mark((function e(t,n){var a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l()({url:"https://api.spotify.com/v1/audio-features/".concat(t),headers:{Authorization:"Bearer ".concat(n)},json:!0});case 3:return(a=e.sent).status&&console.log("GET FEATURES STATUS: ",a.status),console.log("THIS IS THE AUDIO FEATURES",a.data),e.abrupt("return",a.data);case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function h(){return(h=Object(d.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l()({url:"https://api.spotify.com/v1/me",headers:{Authorization:"Bearer ".concat(t)},json:!0});case 3:return(n=e.sent).status&&console.log("GET PROFILE STATUS: ",n.status),e.abrupt("return",n.data);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function b(){return(b=Object(d.a)(p.a.mark((function e(t,n){var a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("setting device..."),e.prev=1,e.next=4,l()({method:"PUT",url:"https://api.spotify.com/v1/me/player",headers:{Authorization:"Bearer ".concat(t)},data:{device_ids:[n]},json:!0});case 4:(a=e.sent).status&&console.log("GET DEVICES STATUS: ",a.status),console.log("THIS IS THE AVAILABLE DEVICES",a.data),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0),a=!1;case 13:return e.prev=13,e.abrupt("return",null===(r=a)||void 0===r?void 0:r.data);case 16:case"end":return e.stop()}}),e,null,[[1,9,13,16]])})))).apply(this,arguments)}var y=Object(a.createContext)(null),v=function(e){var t=e.children,n=Object(a.useRef)(null),o=Object(a.useState)(0),c=Object(i.a)(o,2),s=(c[0],c[1],Object(a.useState)([])),l=Object(i.a)(s,2),u=l[0],p=l[1],d=Object(a.useState)(),h=Object(i.a)(d,2),v=h[0],g=h[1],E=Object(a.useState)(!1),x=Object(i.a)(E,2),O=x[0],S=x[1],j=Object(a.useState)(!1),T=Object(i.a)(j,2),I=T[0],w=T[1],k=Object(a.useState)(!1),_=Object(i.a)(k,2),A=_[0],N=_[1],z=Object(a.useState)(!1),R=Object(i.a)(z,2),P=R[0],L=R[1],D=Object(a.useState)(),C=Object(i.a)(D,2),B=C[0],U=C[1],V=Object(a.useState)(),F=Object(i.a)(V,2),H=F[0],M=F[1],W=Object(a.useState)({features:void 0,analysis:void 0}),G=Object(i.a)(W,2),X=G[0],Y=G[1],Z=Object(a.useState)({current:0,total:0}),q=Object(i.a)(Z,2),J=q[0],K=q[1],$=function(){v.getCurrentState().then((function(e){(null===e||void 0===e?void 0:e.position)&&(null===e||void 0===e?void 0:e.duration)&&(K((function(){return{current:e.position,total:e.duration}})),M(e.position/e.duration))}))},Q=function e(t){if(!P)return console.log("IT IS NOT PLAYING"),n.current=null,cancelAnimationFrame(n.current);P&&($(),requestAnimationFrame(e))};return Object(a.useEffect)((function(){return null==n.current&&(n.current=requestAnimationFrame(Q)),function(){return cancelAnimationFrame(n.current)}}),[P]),Object(a.useEffect)((function(){if(B){var e=B.current_track.id;$(),function(e,t){return f.apply(this,arguments)}(e,u[0]).then((function(t){return function(e,t){return m.apply(this,arguments)}(e,u[0]).then((function(e){return Y({features:e,analysis:t})}))}))}}),[B]),Object(a.useEffect)((function(){u.length>1&&new Promise((function(e){window.Spotify?e():window.onSpotifyWebPlaybackSDKReady=e})).then((function(){g(new window.Spotify.Player({name:"Chromesthetics",getOAuthToken:function(e){return e(u[0])},volume:.05})),S(!0)}))}),[u]),Object(a.useEffect)((function(){v&&(v.addListener("initialization_error",(function(e){var t=e.message;console.error("init error: ".concat(t))})),v.addListener("authentication_error",(function(e){var t=e.message;console.error("auth error: ".concat(t))})),v.addListener("account_error",(function(e){var t=e.message;console.error("account error: ".concat(t))})),v.addListener("playback_error",(function(e){var t=e.message;console.error("play error: ".concat(t))})),v.addListener("player_state_changed",(function(e){console.log("*STATE*",e),null!==e?(I||w(!0),U(e.track_window),L(!e.paused)):w(!1)})),v.addListener("ready",(function(e){var t=e.device_id;console.log("Ready with Device ID",t),A||function(e,t){return b.apply(this,arguments)}(u[0],t).then((function(e){console.log(e),N(e)}))})),v.addListener("not_ready",(function(e){var t=e.device_id;console.log("Device ID has gone offline",t),w(!1)})),v.connect().then((function(e){w(!0),console.log(e)})))}),[v]),r.a.createElement(y.Provider,{value:{connected:I,loggedIn:O,tokens:u,setIsPlaying:L,isPlaying:P,player:v,setLoggedIn:S,setPlayer:g,setTokens:p,setConnected:w,track:B,audioDetails:X,time:J,setTime:K,device:A,currentBarWidth:H}},t)},g=n(47),E=n(48),x=n(39),O=n(40),S=n(54),j=n(83);function T(){var e=Object(g.a)(["\n    transform: ",";\n"]);return T=function(){return e},e}S.a.registerPlugin(j.a);var I=E.a.svg(T(),(function(e){return e.isPlaying?"translate(-50%,-50%)":"translate(-42.5%,-40%)"})),w=function(e){var t=Object(a.useRef)(),n=Object(a.useRef)();return Object(a.useEffect)((function(){e.isPlaying?S.a.to(t.current,{morphSVG:t.current,duration:.125}):S.a.to(t.current,{morphSVG:n.current,duration:.125})}),[e.isPlaying]),r.a.createElement(I,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 31.5 31.5",isPlaying:e.isPlaying},r.a.createElement("path",{id:"Icon_awesome-pause","data-name":"Icon awesome-pause",d:"M10.125,33.68H3.375A3.376,3.376,0,0,1,0,30.3V5.555A3.376,3.376,0,0,1,3.375,2.18h6.75A3.376,3.376,0,0,1,13.5,5.555V30.3A3.376,3.376,0,0,1,10.125,33.68ZM31.5,30.3V5.555A3.376,3.376,0,0,0,28.125,2.18h-6.75A3.376,3.376,0,0,0,18,5.555V30.3a3.376,3.376,0,0,0,3.375,3.375h6.75A3.376,3.376,0,0,0,31.5,30.3Z",transform:"translate(0 -2.18)",fill:"#f5f5f5",ref:t}),r.a.createElement("path",{id:"Icon_awesome-play","data-name":"Icon awesome-play",d:"M29.841,13.209,5.091.406C3.08-.633,0,.376,0,2.947v25.6c0,2.307,2.862,3.7,5.091,2.541l24.751-12.8a2.775,2.775,0,0,0,0-5.082Z",transform:"translate(0 -0.002)",fill:"#fff",ref:n,style:{visibility:"hidden"}}))};function k(){var e=Object(g.a)(["\n\t.player--progressbar {\n\t\t&--current {\n\t\t\twidth: ",";\n\t\t}\n\t}\n"]);return k=function(){return e},e}var _=E.a.div(k(),(function(e){return"".concat(100*e.width,"%")})),A=function(e){var t=Object(a.useContext)(y),n=t.player,o=(t.connected,t.isPlaying),c=(t.setIsPlaying,t.track),s=(t.tokens,t.time),l=t.setTime,u=(t.device,t.currentBarWidth),p=Object(a.useRef)(null),d=Object(a.useRef)(null),f=Object(a.useRef)(),m=(Object(a.useRef)(),Object(a.useState)()),h=Object(i.a)(m,2),b=(h[0],h[1]),v=Object(a.useState)(),g=Object(i.a)(v,2),E=g[0],S=g[1],j=Object(a.useState)(),T=Object(i.a)(j,2),I=(T[0],T[1]),k=Object(a.useState)(!1),A=Object(i.a)(k,2),N=(A[0],A[1]);return r.a.createElement("main",{className:"dashboard"},r.a.createElement("div",{className:"current"},c&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"current--song"},c.current_track.name),r.a.createElement("h2",{className:"current--artist"},c.current_track.artists[0].name))),r.a.createElement("section",{className:"player"},r.a.createElement("div",{className:"player--controls"},r.a.createElement("div",{className:"player--controls--buttons"},r.a.createElement("div",{className:"player--skip-back player--controls--button__wrapper"},r.a.createElement("button",{onClick:function(){return n.previousTrack()},className:"player--skip-back__button player--controls--button"},r.a.createElement(x.a,{icon:O.a}))),r.a.createElement("div",{className:"player--back-30 player--controls--button__wrapper"},r.a.createElement("button",{onClick:function(){var e;e=s.current<=3e4?0:s.current-3e4,n.seek(e)},className:"player--back-30__button player--controls--button"},r.a.createElement("span",{className:"thirty"},"30"),r.a.createElement(x.a,{icon:O.d}))),r.a.createElement("div",{className:"player--play player--controls--button__wrapper"},r.a.createElement("button",{onClick:function(){n.togglePlay().then((function(){return!o&&cancelAnimationFrame(f.current)}))},className:"player--play__button player--controls--button"},r.a.createElement(w,{isPlaying:o}))),r.a.createElement("div",{className:"player--forward-30 player--controls--button__wrapper"},r.a.createElement("button",{onClick:function(){return n.seek(s.current+3e4)},className:"player--forward-30__button player--controls--button"}," ",r.a.createElement("span",{className:"thirty"},"30"),r.a.createElement(x.a,{icon:O.c}))),r.a.createElement("div",{className:"player--skip-forward player--controls--button__wrapper"},r.a.createElement("button",{onClick:function(){return n.nextTrack().then((function(){n.getCurrentState().then((function(e){console.log(e),l((function(){return{current:e.position,total:e.duration}})),clearTimeout(void 0),console.log("THE NEW WIDTH: ",s.current/s.total)}))}))},className:"player--skip-forward__button player--controls--button"},r.a.createElement(x.a,{icon:O.b})))),r.a.createElement(_,{className:"player--progressbar",ref:d,width:u},r.a.createElement("div",{className:"player--progressbar--full"}),r.a.createElement("div",{className:"player--progressbar--current"},r.a.createElement("div",{draggable:"true",onDragStart:function(e){b(e.clientX),S(e.clientX),I(e.clientX),N(!0)},onDrag:function(e){S(e.clientX);d.current.clientWidth;I(E)},onDragEnd:function(e){N(!1),n.seek(s.total*u)},ref:p,className:"player--progressbar--current__thumb"}))))),r.a.createElement("div",{className:"scales"},r.a.createElement("div",{className:"scales--item scales__volume"}),r.a.createElement("div",{className:"scales--item scales__zoom"})))},N=n(9),z=n(37),R=n(25),P=function(e){var t,n=Object(a.useRef)(),o=Object(a.useState)(!1),c=Object(i.a)(o,2),s=(c[0],c[1]),l=Object(a.useState)(!1),u=Object(i.a)(l,2),p=u[0],d=u[1],f=Object(a.useState)(),m=Object(i.a)(f,2),h=(m[0],m[1],Object(a.useState)(0)),b=Object(i.a)(h,2),y=b[0],v=b[1],g=Object(a.useState)({from:void 0,to:void 0,duration:1}),E=Object(i.a)(g,2),x=E[0],O=E[1],S=Object(a.useState)({up:0,down:0}),j=Object(i.a)(S,2),T=(j[0],j[1],e.audioDetails),I=(T.features,T.analysis);Object(a.useEffect)((function(){v(0)}),[null===(t=e.track)||void 0===t?void 0:t.current_track.id]),Object(N.f)((function(){var t,a,r;I&&(y<I.segments.length-1&&1e3*I.segments[y+1].start<e.time.current&&(v(y+1),r=(t=I.segments[y]).duration,a=I.segments[y+1],O({from:t,to:a,duration:r})));n.current.rotation.x+=x.to?x.to.pitches[e.pitchToRotateIndex.x]/10:.05,n.current.rotation.y+=x.to?x.to.pitches[e.pitchToRotateIndex.y]/10:.05,n.current.rotation.z+=x.to?x.to.pitches[e.pitchToRotateIndex.z]/10:.05}));var w=Object(R.c)({to:{scale:x.to?[.5+1.75*x.to.pitches[e.pitchToScaleIndex.x],.5+1.75*x.to.pitches[e.pitchToScaleIndex.y],.5+1.75*x.to.pitches[e.pitchToScaleIndex.z]]:[1,1,1]},config:R.b.wobbly});return r.a.createElement(R.a.mesh,Object.assign({},w,e,{ref:n,onClick:function(e){return d(!p)},onPointerOver:function(e){return s(!0)},onPointerOut:function(e){return s(!1)}}),r.a.createElement("boxBufferGeometry",{args:[1,1,1]}),r.a.createElement(z.a,{attach:"material",factor:.1,color:e.color}))},L=[{pitchToScaleIndex:{x:0,y:2,z:4},pitchToRotateIndex:{x:1,y:3,z:5}},{pitchToScaleIndex:{x:1,y:3,z:5},pitchToRotateIndex:{x:0,y:2,z:4}},{pitchToScaleIndex:{x:2,y:4,z:6},pitchToRotateIndex:{x:3,y:5,z:7}},{pitchToScaleIndex:{x:3,y:5,z:7},pitchToRotateIndex:{x:2,y:4,z:6}},{pitchToScaleIndex:{x:4,y:6,z:8},pitchToRotateIndex:{x:5,y:7,z:9}},{pitchToScaleIndex:{x:5,y:7,z:9},pitchToRotateIndex:{x:4,y:6,z:8}},{pitchToScaleIndex:{x:6,y:8,z:10},pitchToRotateIndex:{x:7,y:9,z:11}},{pitchToScaleIndex:{x:7,y:9,z:11},pitchToRotateIndex:{x:6,y:8,z:10}},{pitchToScaleIndex:{x:8,y:10,z:0},pitchToRotateIndex:{x:9,y:11,z:1}},{pitchToScaleIndex:{x:9,y:11,z:1},pitchToRotateIndex:{x:8,y:10,z:0}},{pitchToScaleIndex:{x:10,y:0,z:4},pitchToRotateIndex:{x:11,y:1,z:5}},{pitchToScaleIndex:{x:11,y:1,z:5},pitchToRotateIndex:{x:10,y:0,z:4}},{pitchToScaleIndex:{x:0,y:4,z:8},pitchToRotateIndex:{x:1,y:5,z:9}}],D=[3,2,1,0,-1,-2,-3];var C=function(e){return console.log("VISUALIZER WAS RENDERED"),r.a.createElement(N.a,{camera:{fov:85,orthographic:!0,position:[0,0,.01]}},r.a.createElement(z.b,null),r.a.createElement("ambientLight",{intensity:.5}),r.a.createElement("spotLight",{position:[10,10,10],angle:.15,penumbra:1}),r.a.createElement("pointLight",{distance:20,intensity:2,position:[1,1,0],color:"#D96B43"}),r.a.createElement("pointLight",{distance:20,intensity:.5,position:[2,4,1],color:"#fff"}),r.a.createElement("pointLight",{distance:20,intensity:1.3,position:[2,1,0],color:"lightblue"}),D.map((function(t,n){return(L=L.map((function(e){return{sort:Math.random(),value:e}})).sort((function(e,t){return e.sort-t.sort})).map((function(e){return e.value}))).map((function(n,a){var o=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0,0],r=a[0]+n*Math.cos(2*Math.PI*t/e),o=(a[1],a[1]+n*Math.sin(2*Math.PI*t/e));return[r,o]}(L.length,a,15);return r.a.createElement(P,{position:[o[0],3*t,o[1]],time:e.time,audioDetails:e.audioDetails,pitchToScaleIndex:n.pitchToScaleIndex,pitchToRotateIndex:n.pitchToRotateIndex,track:e.track,color:a%2===0?"#333":"#ddd"})}))})))};var B=function(){var e,t=Object(a.useState)(),n=Object(i.a)(t,2),o=n[0],c=n[1],s=Object(a.useState)(),u=Object(i.a)(s,2),p=(u[0],u[1]),d=Object(a.useContext)(y),f=d.loggedIn,m=d.tokens,b=d.player,v=d.setTokens,g=d.time,E=d.audioDetails,x=d.track;return Object(a.useEffect)((function(){console.log("production"),console.log("you are currently in production"),e=window.location.href,console.log(e)}),[]),Object(a.useEffect)((function(){m.length>0?f?(o&&!o.closed&&o.close(),function(e){return h.apply(this,arguments)}(m[0]).then((function(e){return p(e)}))):l()("/refresh_token?refresh_token=".concat(m[1])).then((function(e){v((function(t){return[e.data,t[1]]}))})):function e(){var t,n,a=document.cookie.split("; ");a.length>2?(a.forEach((function(e){if(e.includes("a="))t=e.slice(2);else{if(!e.includes("b="))return;n=e.slice(2)}})),v([t,n])):setTimeout(e,300)}()}),[m,f]),r.a.createElement("div",{className:"App"},r.a.createElement(C,{time:g,audioDetails:E,track:x}),f?r.a.createElement("p",{style:{display:"none"}},"you are already logged in!"):r.a.createElement("div",{className:"login"},r.a.createElement("p",{className:"login--text"},"Login to your Spotify Account"),r.a.createElement("button",{className:"login--btn",onClick:function(){return function(e){c(window.open("".concat(e,"login"),"Log In To Your Spotify Account","height=1200,width=800,opener"))}(e)}},"Login")),f&&b&&r.a.createElement(A,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(v,null,r.a.createElement(B,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},87:function(e,t,n){e.exports=n(127)},92:function(e,t,n){},93:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"}},[[87,1,2]]]);
//# sourceMappingURL=main.01b2c920.chunk.js.map